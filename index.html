<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>Mon eBook Pro</title>
<link rel="stylesheet" href="styles.css">
</head>
<body>
<header>
  <h1>Mon eBook Pro</h1>
</header>

<div class="container">
  <img src="images/couverture.jpg" alt="Couverture eBook">
  <h2>Ma Méthode Secrète</h2>
  <p>Apprenez tout ce qu’il faut savoir pour réussir avec ce guide complet.</p>
  <p>Prix : 9€</p>

  <div id="paypal-button-container"></div>
  <a id="download" style="display:none;" href="#">Télécharger votre eBook</a>
</div>

<script src="https://www.paypal.com/sdk/js?client-id=YOUR_CLIENT_ID&currency=EUR"></script>
<script>
paypal.Buttons({
  createOrder: function(data, actions) {
    return fetch('/create-order', { method: 'POST', headers:{'Content-Type':'application/json'}, body: JSON.stringify({price:"9.00",title:"Mon eBook"}) })
      .then(res => res.json())
      .then(order => order.id);
  },
  onApprove: function(data, actions) {
    return fetch('/capture-order', { method:'POST', headers:{'Content-Type':'application/json'}, body: JSON.stringify({orderID: data.orderID}) })
      .then(res => res.json())
      .then(result => {
        if(result.success){
          alert("Paiement réussi !");
          document.getElementById('download').href = result.downloadUrl;
          document.getElementById('download').style.display = "block";
        } else { alert("Erreur paiement."); }
      });
  }
}).render('#paypal-button-container');
</script>
</body>
</html>
